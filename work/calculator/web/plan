План работы:
- Ввод/вывод в процентах
+ Округление
+ Дата
+ Расширенный алгоритм
+ Сообщение если ИГ не может быть до этого срока
+ Файл с настройками по срокам и поддерживаемым данным для банков
+ Скрыть фондирование
+ Графики платежей
+ Протестить PMT
+ Новый вывод
+ Переделать ИГ
+ Добавить надпись что при пролонгации ПЗ гасится до сделки.
+ Для ИГ выводить 2 вида платежей, с ИГ и без ИГ.
+ Если ИГ+пролонгация, то двигать границу между ними пока не будет достигнут максимальный эффект, пару итераций.
+ Рефинансирование
+ Эффект с учетом резервов
+Дисконт
+ Срок реструктуризации(указать что это суммарный срок)
+ добавить возможность удалить добавленный кредит (если случайно добавили или передумали)
+ добавить кнопку очистить все, чтобы начать новый расчет
+ выводить в блоке рестр не только срок рестр, но и общий срок с учетом рестр (суммарный срок сколько был до рестр+рестр), модно в скобках, пока это хотя бы мне для тестирования


Текущий принцип работы алгоритма:

Максимальный платеж разбивается между кредитами пропорционально остатку по кредитам. Если максимальный платеж меньше чем 50% суммарного платежа до этого, то реструктуризация считается невозможной.
Далее есть следующие варианты реструктуризации в порядке приоритета:
- Пролонгация
- Пролонгация + ИГ
- ИГ
- Рефинасирование

В случае если указано, что просрочка гасится до сделки, то рассматривается только пролонгация. Если не указано, то все остальные варианты.
Для всех вариантов каждого кредита производится просчет графика платежей. Если максимальный срок реструктуризации или ИГ превышает срок указанный в настройках для продукта и банка, то этот вариант реструктуризации для кредита отбрасывается.
Далее идет проход по оставшимся вариантам в порядке приоритета и первый вариант который работает для всех кредитов используется. Если таких вариантов нет, то реструктуризация невозможна. 

Дополнение:

Если какой-то вариант реструктуризации для продукта не поддерживается банком, то в настройках максимальный срок реструктуризации просто устанавливается равным 0, что приведет к тому что при рассчетах он будет отброшен.

Дополнение 2:

Для варианта реструктуризации "Пролонгация + ИГ" пропорация в которой платеж делится менжду обычным платежом по кредиту и ИГ определяется следующим образом:

Шаг 1.
Пролонгация до максимального срока, остаток платежа на ИГ. Подсчет эффекта.

Шаг 2.
Уменьшаем срок пролонгации на 1 месяц, если остаток от платежа положительный, то считаем ИГ с этим остатком, если нет, то в качестве финального используем предыдущий шаг. Подсчет эффекта, если эффект на этом шаге хуже эффекта на прошлом шаге, то в качестве финального используем предыдущий шаг. Если нет, то повторяем Шаг 2.
